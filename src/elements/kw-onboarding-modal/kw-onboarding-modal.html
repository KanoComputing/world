<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-image/iron-image.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower_components/web-components/kano-style/typography.html">
<link rel="import" href="../kano-glint-animation/kano-glint-animation.html">

<!--
`kano-modal'
@group Kano Elements
@demo ./kano-modal/demo/kano-modal.html

The following mixins are available for styling:
 -->
<dom-module id="kano-onboarding-modal">
    <template>
        <style>
            :host {
                background-color: #263A48;
                font-family: 'Bariol', Helvetica, Arial, sans-serif;
            }
            :host paper-dialog {
                overflow-y: auto;
                background-color: #263A48;
            }
            :host paper-dialog > * {
                margin: 0px;
            }
            :host .banner {
                position: relative;
                width: 440px;
                background-size: contain;
                background-position: bottom;
                background-repeat: no-repeat;
                transform: translateZ(0);
                padding: 35px 0 0;
                @apply --layout-vertical;
                @apply --layout-center-center;
            }
            :host .close-icon {
                width: 20px;
                position: absolute;
                top: 15px;
                right: 15px;
                cursor: pointer;
                z-index: 1;
            }
            :host .background-left, .background-right {
                position: absolute;
                width: 50%;
                height: 100%;
                background-size: 70%;
                background-repeat: no-repeat;
                z-index: -1;
            }
            :host .background-left {
                top: 0;
                left: 0;
                background-image: url("/assets/start/kano-hero-left.png");
                background-position: 0% 100%;
            }
            :host .background-right {
                top: 0;
                right: 0;
                background-image: url("/assets/start/kano-hero-right.png");
                background-position: 100% 100%;
            }
            :host .login-lock-img {
                width: 13px;
                height: 15px;
            }
            :host .background-wrapper {
                @apply --layout-vertical;
                @apply --layout-center;
                @apply --layout-center-justified;;
            }
            :host .logo-wrapper {
                position: relative;
                width: 280px;
                height: 280px;
                @apply --layout-vertical;
                @apply --layout-center;
                @apply --layout-center-justified;;
            }
            :host .judoka {
                width: 100%;
                height: 100%;
                position: absolute;
                top: 0;
                left: 0;
                opacity: 0;
                background-color: transparent;
                animation: fade-in ease-out 800ms, float ease-in-out 3s infinite;
                animation-delay: 40ms;
                animation-fill-mode: forwards;
            }
            :host .judoka-background {
                height: 85%;
                width: 85%;
                position: absolute;
                top: 30px;
                left: 30px;
                animation: 25s linear infinite spin;
            }
            :host h1 {
                color: #fff;
                margin: 17px 0 10px;
                transform: translateZ(0);
                font-size: 28px;
                padding: 0 40px;
                margin: 15px 0 5px;
                text-align: center;
            }
            :host h4 {
                color: #fff;
                font-size: 18px;
                font-weight: normal;
                padding: 0 40px;
                margin: 15px 0;
                text-align: center;
            }
            :host .action {
                margin: 15px 0 22px;
            }
            :host kano-glint-animation {
                border-radius: 30px;
            }
            :host kano-glint-animation a {
                display: block;
                position: relative;
                background-color: transparent;
                border: none;
                border-radius: 30px;
                font-size: 12px;
                color: #fff;
                background-color: #fe8233;
                font-weight: bold;
                text-transform: uppercase;
                text-decoration: none;
                transition: all linear 200ms;
                cursor: pointer;
                padding: 15px 35px;
            }
            :host kano-glint-animation a:hover {
                background-color: #fd621e;
            }
            :host kano-glint-animation a:focus {
                outline: none;
                background-color: #fff;
                color: #000;
            }
            @media screen and (max-width: 980px) {
                :host .banner {
                    width: 385px;
                }
                :host h1 {
                    font-size: 24px;
                    padding: 0 12px;
                }
                :host h4 {
                    font-size: 16px;
                    padding: 0 20px;
                }
            }
            @media screen and (max-width: 680px) {
                :host .banner {
                    width: 320px;
                }
                :host .action {
                    margin: 10px 0 20px;
                }
            }
            @keyframes fade-in {
                from {opacity: 0;}
                to {opacity: 1;}
            }
            @keyframes spin {
                0% {transform: rotate(0deg);}
                100% {transform: rotate(360deg);}
            }
            @keyframes float {
                0% {transform: translateY(0);}
                50% {transform: translateY(-0.3rem);}
                100% {transform: translateY(0);}
            }
        </style>
        <paper-dialog id="modal" on-iron-overlay-opened="_openAnimation" with-backdrop>
            <div class="banner">
                <img hidden$="[[!closable]]"
                     class="close-icon"
                     src="/assets/icons/modal-close-icon.svg"
                     on-tap="_xTapped"/>
                <div class="background-left"></div>
                <div class="background-right"></div>
                <div class="background-wrapper">
                    <div class="logo-wrapper">
                        <iron-image class="judoka-background" src="/assets/start/hero-judoka-bg.svg" preload fade sizing="contain"></iron-image>
                        <iron-image class="judoka" src="/assets/start/hero-judoka.svg" preload fade sizing="contain"></iron-image>
                    </div>
                    <h1>Want coding superpowers?</h1>
                    <h4>Start out onboarding and learn how to <br> make your computer speak!</h4>
                    <div class="action">
                        <kano-glint-animation running>
                            <a href$="[[config.KANO_CODE_URL]]/onboarding">
                                I want superpowers!
                            </a>
                        </kano-glint-animation>
                    </div>
                </div>
            </div>
        </paper-dialog>
    </template>
</dom-module>

<script>
    Polymer({
        is: 'kano-onboarding-modal',
        properties: {
        },
        attached () {
        },
        _openAnimation () {
            if ('animate' in HTMLElement.prototype) {
                this.$.modal.animate([
                    {transform: 'scale(0.5)'},
                    {transform: 'scale(1)'}
                ], {
                    duration: 200,
                    easing: 'ease-out'
                });
            }
        },
        open () {
            this.$.modal.open();
        },
        close () {
            if ('animate' in HTMLElement.prototype) {
                this.$.modal.animate([
                    {transform: 'scale(1)'},
                    {transform: 'scale(0.5)'}
                ], {
                    duration: 200,
                    easing: 'ease-in'
                }).onfinish = () => {
                    this.$.modal.close();
                };
            }
        },
        _xTapped () {
            this.close();
            this.fire('dismiss');
        }
    });
</script>