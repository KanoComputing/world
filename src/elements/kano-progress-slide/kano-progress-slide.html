<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../bower_components/iron-image/iron-image.html">

<link rel="import" href="../kano-session/kano-session.html">
<link rel="import" href="../kano-style/typography.html">
<link rel="import" href="../kano-style/color.html">

<dom-module id="kano-progress-slide">
    <template>
        <style>
            :host {
                @apply --layout-horizontal;
                @apply --layout-start-justified;
            }
            .step .target {
                width: 30px;
                height: 30px;
                margin: 0px;
                border: 10px solid black;
                border-radius: 50%;
            }
            .step .done {
                background: black;
            }
            .step .label {
                text-align: center;
                margin-top: 5px;
            }
            .step img {
                width: 100px;
            }
            :host ::slotted(*) {
                @apply --layout-center-justified;
            }
            .display-wrapper {
                @apply --layout-horizontal;
                @apply --layout-center;
                position: relative;
                width: 100%;
            }
            .line {
                height: 1px;
                width: 90%;
                top: 50%;
                background-color: #fff;
                position: absolute;
                z-index: 0;
            }
            :host ::slotted(*) {
                @apply --layout-horizontal;
                @apply --layout-center;
                @apply --layout-start-justified;
                position: relative;
                z-index: 1;
                width: 100%;
            }
            :host ::slotted(*) > * {
                position: relative;
                display: inline-block;
            }
            @media screen and (min-width: 1600px) {
            }
            @media screen and (max-width: 980px) {
            }
            @media screen and (max-width: 680px) {
            }
        </style>
        <div class="display-wrapper">
            <div class="line">
            </div>
                <slot name="content">
                </slot>
        </div>
    </template>
    <script>
        Polymer({
            is: 'kano-progress-slide',
            properties: {
                'steps': {
                    type: Array,
                    value: [1,2,3,4,5]
                },
                'step': {
                    type: String,
                    value: 'connect'
                }
            },
            observers: [
                '_computeProgress(user)',
            ],
            ready () {
            },
            _computeProgress (user) {
                if (user && user.profile) {
                    let profile = user.profile,
                        kcProgress = [];
                    if (profile.stats['make-apps'] && profile.stats['make-apps'].progress) {
                        kcProgress = profile.stats['make-apps'].progress;
                        kcProgress = Object.keys(kcProgress).reduce((acc, key) => {
                            return acc.concat(kcProgress[key].completedStories);
                        }, []);
                        console.log('kcProgress', kcProgress);
                    }
                } else {
                }
            },
            isNotLastStep (steps, index) {
                return index !== steps.length - 1;
            },
            _getPathPrefix () {
                if (!this.pathPrefix) {
                    let pathEl = document.head.querySelector('meta[name="path-prefix"]');
                    this.pathPrefix = pathEl ? pathEl.getAttribute('data-value') : '/';
                }
                return this.pathPrefix;
            },
            _userSet (user) {
                console.log('user is', user);
            }
        });
    </script>
</dom-module>
